# Анимации для Blade and Soul

Репозиторий содержит анимации вееров для проекта Blade and Soul.  

Основные компоненты анимации:

* `characters.css` – стили для анимационных персонажей. Важным параметром является `transform-origin` — это точка, относительно которой будет происходить вращение и масштабирование.
* `animation.json` — JSON, описывающий всех персонажей и их анимации.

##Использование анимаций на сайте http://4game.com

Этот проект нужно подключить как зависимость `chewer` к `com.4game`:

`chewer install ssh://git@github.inn.ru/che/bns-animator --save`

После установки зависимости `chewer` автоматически запустит сборку проекта, все анимации будут сохранены в виде JS-файлов внутри папки `out` зависимости `bns-animator`.

Эти JS-файлы — самостоятельные модули, которые достаточно вставить на страницу и они сами сначала подгрузят все необходимые картинки, после чего запустят анимацию.

На 4game анимации можно подключить как модуль Черхитектуры:

`<div class="bns-scene" data-js-widgets="bns-animator/out/[animation].js"></div>`

Анимация будет автоматически загружена и все персонажи будут добавлены внутрь контекстного элемента. У всех персонажей будет класс `anim-object`, которому можно применить дополнительные стили.

## Сборка проекта

Для сборки проекта используется сборщик [Gulp](http://gulpjs.com). Для сборки проекта достаточно вызвать `./buld.sh`.

Если Gulp установлен глобально, то можно просто вызывать `gulp` или `gulp watch` внутри проекта для дебага.

## Как работать с анимациями

Сам движок анимаций состоит из двух частей:

1. Ядро, которое просто анимирует персонажей по данным из `animation.json`
2. UI, с помощью которого можно менять анимации персонажей. Эта часть не попадает в финальную сборку для экономии ресурсов.

Все анимации хранятся в папке `./animations/`. Для создания новой анимации нужно сделать следующее:

1. Создать новую папку внутри `/animations/` с `index.html` из любой существующей анимации.
2. Внутри новой папки описать всех персонажей и их движущихся частей (кости) в `characters.css`.
3. Открыть файл `index.html` в браузере (желательно через веб-сервер).
4. Добавить всех персонжей на сцену. Чтобы добавить персонада нужно нажать на кнопку <kbd>+</kbd> в левом нижнем углу. По умолчанию добавляется красный квадрат. Нужно выделить этот квадрат и в появившейся панели ввести имя CSS-класса персонажа (из `characters.css`).
5. Чтобы добавить движущуюся часть (кость) персонажу, нужно его выделить и в правой панели нажать `addBone`. Дальше присвоить кости CSS-класс так же, как и персонажу. Кости могут быть вложены друг в друга.
6. После того, как анимация будет готова, нужно нажать на кнопку `export` в правом нижнему углу и сохранить полученный JSON как `animation.json` в папку с анимацией. Этот файл также будет подгружаться автоматически при загрузке страницы.
7. В случае, если страницу случайно перезагрузили, то вернуть последнее состояние анимации можно с помощью кнопки `revert`.